<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.9" />
<title>Input Language for Nunchaku</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #808080 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0040D0 } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>Input Language for Nunchaku</h1>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_supported_formats">Supported Formats</h2>
<div class="sectionbody">
<div class="paragraph"><p>Input files are parsed by Nunchaku based on their file extension
or on the <code>--input {nunchaku,tip,tptp}</code> command line argument</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
native format
</dt>
<dd>
<p>
ML-like, reflects precisely the input logic supported by
  Nunchaku. File extension <code>.nun</code>. See <a href="#native-format">[native-format]</a>.
</p>
</dd>
<dt class="hdlist1">
TIP
</dt>
<dd>
<p>
similar to SMT-LIB2, file extension <code>.smt2</code>.
  The format is documented at <a href="https://tip-org.github.io/">https://tip-org.github.io/</a>.
</p>
</dd>
<dt class="hdlist1">
TPTP
</dt>
<dd>
<p>
minimal support, mostly for benchmarks, file extension <code>.p</code>.
  See <a href="http://www.cs.miami.edu/~tptp/">http://www.cs.miami.edu/~tptp/</a>.
</p>
</dd>
</dl></div>
</div>
</div>
<div class="sect1">
<h2 id="native-format">Native Format (<code>.nun</code>)</h2>
<div class="sectionbody">
<div class="paragraph"><p>A few example files can be found in in <a href="examples/index.html">examples/index.html</a> and in
the <a href="https://github.com/nunchaku-inria/nunchaku-problems">nunchaku-problems repository</a>.</p></div>
<div class="sect2">
<h3 id="_a_few_examples">A few examples</h3>
<div class="ulist"><ul>
<li>
<p>
An unsatisfiable problem about <code>append</code> and <code>cons</code> on lists.
  We first define an uninterpreted type <code>a</code> for the list elements,
  then the datatype of lists of <code>a</code>. <code>x</code> and <code>xs</code> are undefined symbols
  of type <code>a</code> and <code>list</code>.
  Then we define the <em>admissible</em> recursive function <code>append</code> (it is total
  and terminating) that concatenates two lists, and
  specify an (unsatisfiable) goal <code>∃ x ys. append (cons x []) y ≠ cons x y</code>.
</p>
<div class="listingblock">
<div class="content">
<pre><code>val a : type.

data list :=
  Nil
| Cons a list.

val x : a.
val ys : list.

rec append : list -&gt; list -&gt; list :=
  forall ys. append Nil ys = ys;
  forall x xs ys. append (Cons x xs) ys = Cons x (append xs ys).

goal ~ (append (Cons x Nil) ys = Cons x ys).</code></pre>
</div></div>
<div class="paragraph"><p>Running Nunchaku (with the CVC4 backend) on this problem will give:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ nunchaku append.nun -s cvc4
UNSAT
{backend:cvc4, time:0.0s}</code></pre>
</div></div>
</li>
<li>
<p>
A few datatypes, with polymorphism, recursive functions, and comments.
</p>
<div class="listingblock">
<div class="content">
<pre><code>data nat :=
  | zero
  | succ nat.

rec plus : nat -&gt; nat -&gt; nat :=
  forall x. plus zero x = x;
  forall x y. plus (succ x) y = succ (plus x y).

# polymorphic list
data list a :=
  | nil
  | cons a (list a).

# rose tree (with a list of children)
data tree :=
  | node (list tree).

rec size : tree -&gt; nat :=
  forall l. size (node l) = succ (size_list l)
and size_list : list tree -&gt; nat :=
  size_list nil = zero;
  forall t l. size_list (cons t l) = plus (size t) (size_list l).

# compute the size of some tree
goal
  let t0 := node nil in
  let t := node (cons t0 (cons t0 nil)) in
  let t2 := node (cons t nil) in
  exists n. size t2 = n.</code></pre>
</div></div>
<div class="paragraph"><p>Running Nunchaku gives us a model. The model might change depending
on which solver succeeds first.
In this particular case, the problem is solved by
<a href="https://github.com/c-cube/smbc/">SMBC</a> (installable by <code>opam install smbc</code>).
Note how the model defines the <em>witness</em> for the <code>exists n. size t2 = n</code>
to the actual size of the tree, 4.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ nunchaku example.nun
SAT: {
  val _witness_of (exists (n/494:nat). size t2/493 = n/494) :=
    succ (succ (succ (succ zero))).
}
{backend:smbc, time:0.0s}</code></pre>
</div></div>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_bnf_syntax">BNF syntax</h3>
<div class="paragraph"><p>We will use a BNF-like syntax to describe the grammar of this format.
In the following, <code>&lt;foo&gt;</code> represents the syntactical class of foos
(e.g. <code>&lt;term&gt;</code> represents the grammar of terms), <code>'foo'</code> is the
verbatim text "foo", and <code>&lt;foo&gt; ::= a | b | c</code> states that the entry
<code>&lt;foo&gt;</code> corresponds to the cases a, b, and c.
<code>[a b c]</code> is used for parenthesing; <code>a?</code> makes <code>a</code> optional;
<code>a*</code> represents any number of consecutive <code>a</code>; <code>a+</code> represents any non-empty
sequence of <code>a</code>.</p></div>
</div>
<div class="sect2">
<h3 id="_terms_and_types">Terms and Types</h3>
<div class="paragraph"><p>Terms are written in a ML-like language that should be easy to read.
Types are polymorphic and all type quantification should be prenex.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
Types
</dt>
<dd>
<div class="paragraph"><p>Basic types can be declared by <code>val &lt;id&gt;: [type -&gt;]* type.</code>
or defined as (co)datatypes (see <a href="#datatype-def">[datatype-def]</a>).
Other types are built using basic types, <code>prop</code> (propositions),
<code>a b c</code> (where <code>a : type -&gt; type -&gt; type</code> and <code>b, c: type</code>),
<code>a -&gt; b</code> where <code>a</code> and <code>b</code> are types (right associative: <code>a -&gt; b -&gt; c</code>
is <code>a -&gt; (b -&gt; c)</code>) and type variables that are introduced by
prenex quantification <code>pi a. &lt;type&gt;</code>.
For example, after declaring <code>i:type</code> and <code>array: type -&gt; type -&gt; type</code>,
the following are well-formed types:</p></div>
<div class="ulist"><ul>
<li>
<p>
<code>i</code>
</p>
</li>
<li>
<p>
<code>i-&gt;i</code>
</p>
</li>
<li>
<p>
<code>pi a. array a i -&gt; a -&gt; i -&gt; prop</code>
</p>
</li>
<li>
<p>
<code>pi a. (a -&gt; prop) -&gt; a</code>
</p>
</li>
<li>
<p>
<code>pi a b c. array a b -&gt; (array b c -&gt; i -&gt; prop) -&gt; prop</code>
</p>
<div class="listingblock">
<div class="content">
<pre><code>&lt;id&gt; ::= [a-zA-Z][a-zA-Z0-9$_]*]
&lt;var&gt; ::= &lt;id&gt;
&lt;typed-var&gt; ::= &lt;var&gt; | '(' &lt;var&gt; ':' &lt;type&gt; ')'
&lt;atomic-type&gt; ::= 'type'
                | 'prop'
                | '(' &lt;type&gt; ')'
&lt;type&gt; ::= &lt;atomic-type&gt;
         | &lt;atomic-type&gt; '-&gt;' &lt;type&gt;
         | 'pi' &lt;typed-var&gt; '.' &lt;type&gt;</code></pre>
</div></div>
</li>
</ul></div>
</dd>
<dt class="hdlist1">
Terms
</dt>
<dd>
<div class="paragraph"><p>Terms belong to the polymorphic higher-order logic. Formulas are just terms
of type <code>prop</code>, and logical connectives are function symbols of type <code>prop -&gt; prop</code>
and <code>prop -&gt; prop -&gt; prop</code>.
In addition to basic function symbols, that are declared using <code>val &lt;id&gt;: &lt;type&gt;.</code>
or defined as recursive functions or (co)inductive predicates,
terms can be built using the following constructs:</p></div>
<div class="ulist"><ul>
<li>
<p>
builtins (see <a href="#builtins">[builtins]</a>)
</p>
</li>
<li>
<p>
basic function symbols
</p>
</li>
<li>
<p>
(bound) variables
</p>
</li>
<li>
<p>
lambda-abstraction <code>fun x. &lt;term&gt;</code> where <code>x</code> is bound in the body.
  The type of <code>x</code> can be explicitely specified: <code>fun (x:&lt;type&gt;). &lt;term&gt;</code>.
  Functions with multiple arguments can be shortened as <code>fun x y z. &lt;term&gt;</code>.
</p>
</li>
<li>
<p>
quantifiers: <code>forall x. &lt;term&gt;</code> and <code>exists x. &lt;term&gt;</code> where the
  body must be of type <code>prop</code>.
</p>
</li>
<li>
<p>
let-bindings <code>let x := &lt;term&gt; in &lt;term&gt;</code>, where <code>x</code> is bound in
  the second term.
</p>
</li>
<li>
<p>
tests <code>if a b c</code> where <code>a:prop</code> and <code>b,c</code> are terms that have the
  same type (which is also the type of <code>if a b c</code>).
</p>
</li>
<li>
<p>
shallow pattern-matching on (co)datatypes:
  <code>match &lt;term&gt; with &lt;branches&gt; end</code>. Each branch has the form
  <code>| &lt;constructor&gt; [&lt;variable&gt;]* -&gt; &lt;term&gt;</code> and deals with
  the corresponding constructor case. Constructors must always be
  fully applied (no matching on functions).
</p>
<div class="paragraph"><p>example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>data foo := A | B | C.
rec f : foo -&gt; prop :=
  forall x. f x =
    match x with
    | A -&gt; true
    | B -&gt; false
    | C -&gt; true
    end.</code></pre>
</div></div>
</li>
<li>
<p>
connectives:
</p>
<div class="ulist"><ul>
<li>
<p>
conjunction <code>&amp;&amp;</code>
</p>
</li>
<li>
<p>
disjunction <code>||</code>
</p>
</li>
<li>
<p>
negation <code>~</code>
</p>
</li>
<li>
<p>
implication <code>=&gt;</code>
</p>
</li>
<li>
<p>
equality <code>=</code> (note that equivalence is just equality on propositions)
</p>
<div class="paragraph"><p>Negation binds tightly, and <code>&amp;&amp;</code> takes precedence over <code>||</code> and <code>=&gt;</code>.</p></div>
</li>
</ul></div>
</li>
<li>
<p>
parenthesing can be used to override precedences, e.g. in <code>if (f a) b c</code>.
</p>
<div class="listingblock">
<div class="content">
<pre><code>&lt;constant&gt; ::= &lt;id&gt; | '@'&lt;id&gt;  // must be defined or declared above
&lt;atomic-term&gt; ::= &lt;var&gt;
                | &lt;constant&gt;
                | '(' &lt;term&gt; ')'
                | 'match' &lt;term&gt; 'with' &lt;match-branch+&gt; 'end'

&lt;apply-term&gt; ::= &lt;atomic-term&gt;+ | '~' &lt;apply-term&gt;
&lt;eq-term&gt; ::= &lt;apply-term&gt;
            | &lt;apply-term&gt; '=' &lt;apply-term&gt;
            | &lt;apply-term&gt; '!=' &lt;apply-term&gt;
&lt;and-term&gt; ::= &lt;eq-term&gt;
             | &lt;eq-term&gt; '&amp;&amp;' &lt;and-term&gt;
&lt;or-term&gt; ::= &lt;and-term&gt;
             | &lt;and-term&gt; '||' &lt;or-term&gt;
             | &lt;and-term&gt; '=&gt;' &lt;or-term&gt;
&lt;term&gt; ::= &lt;or-term&gt;
         | 'fun' &lt;typed-var&gt;+ '.' &lt;term&gt;
         | 'let' &lt;var&gt; ':=' &lt;term&gt; 'in' &lt;term&gt;
         | 'if' &lt;term&gt; 'then' &lt;term&gt; 'else' &lt;term&gt;
         | 'forall' &lt;typed-var&gt;+ '.' &lt;term&gt;
         | 'exists' &lt;typed-var&gt;+ '.' &lt;term&gt;

&lt;match-branch&gt; ::= '|' &lt;id&gt; &lt;var&gt;* '-&gt;' &lt;term&gt;</code></pre>
</div></div>
</li>
</ul></div>
</dd>
</dl></div>
<div class="paragraph"><p>The following example demonstrates a possible way of defining functions
with <code>match</code> and <code>fun</code>:</p></div>
<div class="paragraph"><p>+</p></div>
<div class="listingblock">
<div class="content">
<pre><code>data foo := A | B | C.

rec test_foo : foo -&gt; prop :=
  forall x. test_foo x =
    match x with
    | A -&gt; true
    | B -&gt; false
    | C -&gt; true
    end.

rec swap_foo : foo -&gt; foo :=
  swap_foo = (fun x.
    match x with
    | A -&gt; B
    | B -&gt; C
    | C -&gt; A
    end).

goal (exists x. test_foo x) &amp;&amp; (exists x. swap_foo x = C).</code></pre>
</div></div>
<div class="dlist"><dl>
<dt class="hdlist1">
Polymorphism
</dt>
<dd>
<p>
  The input of Nunchaku is polymorphic, and the polymorphism is explicit:
  a polymorphic symbol will take explicit type parameters.
  For example, <code>rec append : pi a. list a -&gt; list a -&gt; list a</code>
  is a binary function on lists, but it takes 3 arguments (the type <code>a</code>
  and the two lists).
</p>
<div class="paragraph"><p>Because Nunchaku&#8217;s native input is designed to be easy to read and write,
and because Nunchaku performs type inference,
type parameters can be omitted by default.
However, sometimes Nunchaku might not be able to infer some type parameters
and will complain. In this case, the notation <code>@append &lt;type&gt; &lt;list&gt; &lt;list&gt;</code>
can be used to provide the type parameter explicitely.
Similarly, in binders, the type of the variable is omitted by default
by can be made explicit using <code>&lt;binder&gt; (x:&lt;type&gt;). &lt;body&gt;</code>.</p></div>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_statements">Statements</h3>
<div class="paragraph"><p>Common statements are the following:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
declaration
</dt>
<dd>
<p>
<code>val foo : bar</code> where <code>foo</code> is an identifier and <code>bar</code>
  is a type or <code>type</code> (for declaring types themselves):
</p>
<div class="listingblock">
<div class="content">
<pre><code>val i : type.
val array : type -&gt; type -&gt; type.

val i1 : i.
val i2 : i.
val some_array : array i prop.</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
(co)datatypes definitions
</dt>
<dd>
<p>
each datatype is declared using
  <code>data &lt;id&gt; [&lt;variable&gt;]* := [&lt;case&gt;]+</code>, cases being separated using <code>|</code>.
  Mutual definitions are separated by <code>and</code>.
  Codatatypes are introduced using <code>codata</code>.
  It is impossible to define datatypes and codatatypes that are
  mutually recursive (all mutual definitions must be of the same "kind").
</p>
<div class="listingblock" id="datatype-def">
<div class="content">
<pre><code># tuples
data pair a b := Pair a b.

# lists
data list a := Nil | Cons a (list a).

# mutually recursive list and tree
data tree a := Tree a (tree_list a)
and tree_list a := T_nil | T_cons (tree a) (tree_list a).

# streams
codata stream a := S_cons a (stream a).</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
(co)recursive definitions
</dt>
<dd>
<p>
introduced using <code>rec &lt;id&gt; : &lt;type&gt; := &lt;axioms&gt;</code>.
  Mutual definitions are separated using <code>and</code>. Each definition
  declares a new identifier with its type, followed by a non-empty list
  of formulas (separated by <code>;</code>) that must be universally-quantified
  equations with the <code>&lt;id&gt;</code> as left-hand-side head.
</p>
<div class="listingblock">
<div class="content">
<pre><code>rec &lt;id&gt; : &lt;type&gt; :=
  &lt;form&gt; [; &lt;form&gt;]*
[and &lt;id&gt; : &lt;type&gt; :=
  &lt;form&gt; [; &lt;form&gt;]*]*.</code></pre>
</div></div>
<div class="paragraph"><p>example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>data nat := Z | S nat.

rec f : nat -&gt; nat -&gt; nat :=
  forall n. f Z n = S n;
  forall m n. f (S m) n = S (f m n).

rec hof : (nat -&gt; nat) -&gt; nat -&gt; nat :=
  forall f n. hof f n = f (f n).</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
(co)inductive predicates
</dt>
<dd>
<p>
inductive predicates are defined as least fixpoints
  (resp. greatest fixpoints for coinductive predicates) by a list
  of clauses. The modifier <code>[wf]</code> should only be used for predicates that
  are <strong>known</strong> by the user to be well-founded. For other predicates,
  Nunchaku will force the well-foundedness by adding a decreasing parameter
  in every clause.
  Copredicates are introduced using the keyword <code>copred</code>.
</p>
<div class="listingblock">
<div class="content">
<pre><code>data nat := zero | Suc nat.

pred [wf] even : nat -&gt; prop :=
  even zero;
  forall (n : nat). odd n =&gt; even (Suc n)
and odd : nat -&gt; prop :=
  forall (n : nat). even n =&gt; odd (Suc n).</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
axioms
</dt>
<dd>
<p>
<code>axiom t</code> where <code>t : prop</code> is a formula. This axiom will
  be enforced in the model.
  Note that universally quantified axioms might be impossible for
  backend solvers to enforce. It is best to use definitions rather
  than axioms whenever possible.
</p>
<div class="listingblock">
<div class="content">
<pre><code>val i : type.
val a : i.
val p : i -&gt; prop.
val q : i -&gt; prop.
axiom  p i = q i.</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
spec
</dt>
<dd>
<p>
like a set of axioms, but also defines some symbols. The syntax
  is <code>spec [&lt;id&gt;: &lt;type&gt;]+ := &lt;axiom&gt; [; &lt;axiom&gt;]*.</code>: a series of
  type declarations followed by axioms that specify the newly introduced
  symbols.
</p>
<div class="paragraph"><p>The intended semantics of <code>spec</code> is that the axioms are consistent
together and that it is safe to omit the <code>spec</code> if the symbols
it declared are not (transitively) used in the goal.
Therefore, a spec declaration will be kept only if at least one symbol is
transitively used from the goal.
In the following example, if the goal (or some definition used in goal)
does not mention <code>head</code> nor <code>tail</code>, the spec will be dropped.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>data list a :=
  | nil
  | cons a (list a).

spec head : pi a. list a -&gt; a
and tail : pi a. list a -&gt; list a :=
    forall x l. head (cons x l) = x;
    forall x l. tail (cons x l) = l.</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
copy types
</dt>
<dd>
<p>
type alias, refinement types, etc. See <a href="#copy-types">[copy-types]</a>
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="copy-types">Copy Types</h3>
<div class="paragraph"><p>A copy type is used to define a type from another type. It can take
the following forms:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
type alias
</dt>
<dd>
<p>
the simplest case (below, <code>pair1</code>)
</p>
</dd>
<dt class="hdlist1">
refinement type
</dt>
<dd>
<p>
a copy of a type, only retaining values of this
  type that satisfy a given predicate
</p>
</dd>
<dt class="hdlist1">
quotient type
</dt>
<dd>
<p>
a copy of the type, quotiented by a relation
  that <strong>must</strong> be an equivalence relation (reflexive symetric transitive).
</p>
</dd>
</dl></div>
<div class="listingblock">
<div class="content">
<pre><code>data pair a b := Pair a b.

copy pair1 a := pair a a
  abstract pair1_of_pair
  concrete pair_of_pair1.

val iota : type.

goal forall (p:pair1 iota).
     exists (x:iota) (y:iota).
     pair_of_pair1 p = Pair x y.</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_include_directive">Include directive</h3>
<div class="paragraph"><p>It is possible to write commonly used
definitions and axioms in a file, and include that file from
other files:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
foo.nun
</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre><code>val p : prop.</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
bar.nun
</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre><code>include "foo.nun".

goal p || ~ p. # trivial, but needs `p` to be declared!</code></pre>
</div></div>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_cardinality_bounds">Cardinality Bounds</h3>
<div class="paragraph"><p>The two following problems define an uninterpreted type and put bounds
on its cardinality. Both are unsatisfiable because of  the bound
and additional axioms:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>val i : type [max_card 2].

val i1 : i.
val i2 : i.
val i3 : i.

# at least three distinct elements
axiom (i1 != i2 &amp;&amp; i2 != i3 &amp;&amp; i1 != i3).</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>val i : type [min_card 3].

val a : i.
val b : i.

# at most 2 elements, clashes with constraint on i
axiom forall x. x = a || x = b.</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="builtins">Builtins</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
choice operators
</dt>
<dd>
<p>
with type <code>pi a. (a -&gt; prop) -&gt; a</code>
</p>
<div class="ulist"><ul>
<li>
<p>
<code>choice</code> picks a value that satisfies the
    predicate if at least one such value exists
</p>
</li>
<li>
<p>
<code>unique</code> picks the value that satisfies the predicate,
    if exactly one such value exists.
</p>
</li>
<li>
<p>
<code>unique_unsafe</code> is similar to <code>unique</code>, but to be used only if it is
    guaranteed that exactly one value satisfies the predicate.
    <strong>NOTE</strong> use only if you know what you are doing!
</p>
</li>
</ul></div>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_design_goals">Design Goals</h3>
<div class="paragraph"><p>The native language must support:</p></div>
<div class="ulist"><ul>
<li>
<p>
non interpreted types
</p>
</li>
<li>
<p>
data
</p>
</li>
<li>
<p>
codata
</p>
</li>
<li>
<p>
quotient type
</p>
</li>
<li>
<p>
subtype (refinement type)
</p>
</li>
<li>
<p>
axioms (to partially define non interpreted symbols)
</p>
</li>
<li>
<p>
recursive fun
</p>
</li>
<li>
<p>
corecursive fun
</p>
</li>
<li>
<p>
inductive predicate
</p>
</li>
<li>
<p>
coinductive predicate
</p>
</li>
</ul></div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2017-03-09 11:33:33 CET
</div>
</div>
</body>
</html>
